p8105_hw2_zz3167
================
Zhiyi Zhu
2023-09-29

``` r
library(tidyverse)
library(readxl)
library(dplyr)
```

## Problem 1

### Clean the data in pols-month.csv

``` r
pols_df = 
  read_csv("data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.numeric(year)
  ) |>
  mutate(
    month = case_match(
      month,
      "01" ~ "January",
      "02" ~ "Febuary",
      "03" ~ "March",
      "04" ~ "Aprial",
      "05" ~ "May",
      "06" ~ "June",
      "07" ~ "July",
      "08" ~ "August",
      "09" ~ "September",
      "10" ~ "October",
      "11" ~ "November",
      "12" ~ "December" )
  ) |>
  mutate(
    president = case_match(
      prez_gop,
      1 ~ "gop",
      0 ~ "dem" )
  ) |>
  select(-prez_gop, -prez_dem, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Clean the data in snp.csv

``` r
snp_df = 
  read_csv("data/snp.csv") |>
  janitor::clean_names() |>
  mutate(
    date = as.Date(date, format = "%m/%d/%y"),
    date = as.Date(ifelse(date > Sys.Date(),
                           format(date, "19%y-%m-%d"),
                           format(date)))
  ) |>
  separate(date, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.numeric(year)
  ) |>
  select(-day) |>
  arrange(year,month) |>
  mutate(
     month = case_match(
      month,
      "01" ~ "January",
      "02" ~ "Febuary",
      "03" ~ "March",
      "04" ~ "Aprial",
      "05" ~ "May",
      "06" ~ "June",
      "07" ~ "July",
      "08" ~ "August",
      "09" ~ "September",
      "10" ~ "October",
      "11" ~ "November",
      "12" ~ "December" )
   ) |>
  select(year, month, everything())
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Clean the the data in unemployment.csv

``` r
unem_df = 
  read_csv("data/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(jan:dec,
               names_to = "month",
               values_to = "unemployment percentage"
               )|>
  mutate(
    month = case_match(
      month,
      "jan" ~ "January",
      "feb" ~ "Febuary",
      "mar" ~ "March",
      "apr" ~ "April", 
      "may" ~ "May",
      "jun" ~ "June",
      "jul" ~ "July",
      "aug" ~ "August",
      "sep" ~ "September",
      "oct" ~ "October",
      "nov" ~ "November",
      "dec" ~ "December")
  )
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Join the datasets by merging snp into pols, and merging unemployment into the result

``` r
snp_pols_df = 
  left_join(pols_df, snp_df, by = c("year", "month"))

merged_df = 
  left_join(snp_pols_df, unem_df, by = c("year", "month"))
```

### Write a short paragraph about these datasets

- The dataset `pols_df` has 822 rows(observations) and 9
  columns(variables). The range of the year is from January 1947 to
  June 2015. The key variables are year, month, gov_gop, sen_gop,
  rep_gop, gov_dem, sen_dem, rep_dem, president.
- The dataset `snp_df` has 787 rows(observations) and 3
  columns(variables). The range of years is from January 1950 to
  July 2015. The key variables are year, month, close.
- The dataset `unem_df` has 816 rows(observations) and 3
  columns(variables). The range of years is from January 1948 to
  June 2015. The key variables are year, month, unemployment percentage.
- The resulting dataset `merged_df` has 822 rows(observations) and 11
  columns(variables). The range of years is from January 1947 to
  June 2015. The names of key variables are year, month, gov_gop,
  sen_gop, rep_gop, gov_dem, sen_dem, rep_dem, president, close,
  unemployment percentage.

## Problem 2

### Read and clean the Mr. Trash Wheel sheet

``` r
MrTrash_df = 
  read_excel("data/202207 Trash Wheel Collection Data.xlsx",sheet = "Mr. Trash Wheel", range = "A2:N549")|>
  janitor::clean_names()|>
  separate(date, into = c("year", "month0", "day"), sep = "-")|>
  select(-month0)|>
  relocate(year, .before = month)
```

### Update the data to include a new homes_powered variable

``` r
MrTrash_df = 
  mutate(
    MrTrash_df,
    homes_powered = weight_tons*500/30
      )
```

### Use a similar process to work with Professor Trash Wheel and Gwynnda

``` r
ProfessorTrash_df = 
  read_excel("data/202207 Trash Wheel Collection Data.xlsx",sheet = "Professor Trash Wheel", range = "A2:M96")|>
  janitor::clean_names()|>
  separate(date, into = c("year", "month0", "day"), sep = "-")|>
  select(-month0)|>
  relocate(year, .before = month)|>
  mutate(homes_powered = weight_tons*500/30)
```

``` r
Gwynnda_df = 
  read_excel("data/202207 Trash Wheel Collection Data.xlsx",sheet = "Gwynnda Trash Wheel", range = "A2:K108")|>
  janitor::clean_names()|>
  separate(date, into = c("year", "month0", "day"), sep = "-")|>
  select(-month0)|>
  relocate(year, .before = month)|>
  mutate(homes_powered = weight_tons*500/30)
```

### Add an additional variable to all datasets to keep track

``` r
MrTrash_df = mutate(MrTrash_df, track = "Mr Trash wheel")
ProfessorTrash_df = mutate(ProfessorTrash_df, track = "Professor Trash Wheel")
Gwynnda_df = mutate(Gwynnda_df, track = "Gwynnda Trash wheel")
```

### Combine the two dataset with Mr. Trash Wheel and do some adjustment

``` r
Combine_trash = bind_rows(MrTrash_df, ProfessorTrash_df, Gwynnda_df)
Combine_trash = relocate(Combine_trash, track, .before = year)
Combine_trash = relocate(Combine_trash, homes_powered, .after = plastic_bags)
```

<mark> dumpster has more than one start

### Write a paragraph about these data

- The dataset `MrTrash_df` has 547 rows(observations) and 15
  columns(variables). The key variables are dumpster, year, month, day,
  weight_tons, volume_cubic_yards, plastic_bottles, polystyrene,
  cigarette_butts, glass_bottles, grocery_bags, chip_bags, sports_balls,
  homes_powered, track.
- The dataset `ProfessorTrash_df` has 94 rows(observations) and 14
  columns(variables). The key variables are dumpster, year, month, day,
  weight_tons, volume_cubic_yards, plastic_bottles, polystyrene,
  cigarette_butts, glass_bottles, grocery_bags, chip_bags,
  homes_powered, track.
- The dataset `Gwynnda_df` has 106 rows(observations) and 12
  columns(variables). The key variables are dumpster, year, month, day,
  weight_tons, volume_cubic_yards, plastic_bottles, polystyrene,
  cigarette_butts, plastic_bags, homes_powered, track.
- The resulting dataset `Combine_trash` has 747 rows(observations) and
  16 columns(variables). The key variables are dumpster, track, year,
  month, day, weight_tons, volume_cubic_yards, plastic_bottles,
  polystyrene, cigarette_butts, glass_bottles, grocery_bags, chip_bags,
  sports_balls, plastic_bags, homes_powered.
- The total weight of trash collected by Professor Trash Wheel is 190.12
  tons. The total number of cigarette butts collected by Gwynnda in July
  of 2021 is 1.63^{4}.

## Problem 3

### Import, clean, and tidy the dataset of baseline demographics

``` r
baseline_df = 
  read_csv("data_mci/MCI_baseline.csv", skip = 1) |>
  janitor::clean_names()|>
  mutate(
    sex = case_match(
      sex,
      1 ~ "male",
      0 ~ "female")
  )|>
  mutate(
    apoe4 = case_match(
      apoe4,
      1 ~ "APOE4 carrier", 
      0 ~ "APOE4 non-carrier")
  )
```

    ## Rows: 483 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Age at onset
    ## dbl (5): ID, Current Age, Sex, Education, apoe4
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
filter_baseline_df = filter(baseline_df, age_at_onset != '.')
```

### Discuss important steps in the import process

- We use read_csv function to import data, then we use skip = 1 function
  to skip the first row cause it’s the given notes help us to understand
  what the numbers in each columns represent.
- We use mutate function to change the sex and apoe4 values according to
  the explanation in row 1.
- We use filter function to remove any participants who do not meet the
  stated inclusion criteria.

### Discuss relevant features of the dataset

- There are 483 participants, among which 97 developed MCI.
- The average baseline age is 65.0467909.
- 14.22% women in the study are APOE4 carriers.

### Import, clean, and tidy the dataset of longitudinally observed biomarker values

``` r
amyloid_df = 
  read_csv("data_mci/mci_amyloid.csv", skip = 1) |>
  janitor::clean_names()|>
  rename(id = study_id)
```

    ## Rows: 487 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (5): Baseline, Time 2, Time 4, Time 6, Time 8
    ## dbl (1): Study ID
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

### Comment on the steps

- We use read_csv function to import data, then we use skip = 1 function
  to skip the first row which is the explanation.
- We use rename function to change the “study_id” to “id” in order to
  easily combine or compare the two dataset.

### Check whether some participants appear in only the baseline or amyloid datasets

``` r
only_baseline = anti_join(filter_baseline_df, amyloid_df, by = "id")
only_amyloid = anti_join(amyloid_df, filter_baseline_df, by = "id")
```

<mark> which one? filter_baseline_df / baseline_df ?

- There are 3 participants only appear in baseline dataset, their ids
  are 14, 49, 268.
- There are 393 participants only appear in amyloid dataset, their ids
  are 1, 2, 4, 6, 8, 9, 10, 11, 12, 15, 16, 17, 19, 20, 21, 23, 24, 25,
  27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 44, 46, 47,
  48, 50, 51, 52, 53, 54, 56, 57, 58, 60, 61, 62, 63, 64, 66, 68, 70,
  71, 73, 74, 79, 80, 81, 82, 83, 84, 85, 88, 90, 91, 93, 94, 95, 96,
  97, 98, 99, 100, 101, 102, 103, 104, 105, 107, 108, 110, 111, 112,
  113, 114, 115, 116, 117, 118, 119, 121, 122, 124, 125, 126, 127, 128,
  129, 130, 131, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143,
  144, 145, 147, 148, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159,
  160, 161, 162, 163, 164, 165, 167, 168, 169, 171, 172, 173, 174, 175,
  176, 178, 180, 181, 182, 183, 184, 185, 187, 188, 189, 190, 191, 192,
  193, 194, 195, 196, 197, 198, 199, 200, 201, 203, 204, 205, 206, 207,
  208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 219, 220, 221, 222,
  223, 224, 225, 227, 228, 231, 232, 233, 235, 236, 237, 238, 239, 240,
  241, 243, 244, 245, 246, 247, 248, 251, 253, 254, 255, 256, 257, 258,
  259, 260, 261, 262, 263, 264, 265, 266, 267, 269, 270, 271, 272, 273,
  274, 275, 276, 278, 279, 281, 282, 284, 285, 288, 290, 291, 293, 294,
  295, 296, 298, 299, 300, 302, 303, 307, 308, 309, 310, 311, 312, 313,
  315, 316, 317, 318, 319, 320, 321, 322, 324, 325, 326, 327, 329, 330,
  331, 332, 333, 334, 335, 339, 340, 341, 342, 343, 344, 345, 346, 353,
  354, 356, 357, 358, 359, 360, 361, 362, 363, 364, 367, 368, 370, 371,
  372, 374, 375, 376, 378, 381, 382, 383, 384, 385, 386, 387, 388, 390,
  391, 392, 393, 394, 395, 396, 397, 399, 401, 402, 403, 404, 405, 406,
  407, 410, 411, 413, 414, 415, 418, 420, 421, 422, 425, 427, 428, 429,
  430, 432, 433, 434, 435, 436, 437, 438, 439, 441, 443, 444, 445, 446,
  447, 450, 451, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464,
  465, 466, 467, 468, 469, 470, 472, 473, 474, 475, 476, 477, 478, 479,
  480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493,
  494, 495.

### Combine the demographic and biomarker dataset

``` r
combine_df = inner_join(filter_baseline_df, amyloid_df, by = "id")
```

### Briefly describe the resulting dataset

- There are 94 participants appear in both dataset. 50 are male, and 62%
  of them are APOE4 carriers. 44 are female, and 65.91% of them are
  APOE4 carriers.
